{
  "info": {
    "name": "ViePropChain - Hybrid Architecture Complete (API Gateway)",
    "description": "ï¿½ **HYBRID ARCHITECTURE** - Complete NFT Marketplace Testing\n\n**âœ… IMPLEMENTED FEATURES:**\n- ğŸ”¥ **ERC721Enumerable** NFT Querying (FIXED)\n- âš¡ **Fast Read APIs** tá»« MongoDB (50ms vs 3s)\n- ğŸ¯ **Blockchain Event Indexer** (Auto-sync)\n- ğŸ’° **Complete Marketplace** vá»›i listings & offers\n- ğŸ”„ **Real-time sync** giá»¯a Blockchain & Database\n\n**KIáº¾N TRÃšC HYBRID:**\n```\nWRITE: Frontend â†’ Smart Contract â†’ Events â†’ Indexer â†’ MongoDB\nREAD:  Frontend â†’ API â†’ MongoDB (Fast) â†’ Formatted Response\n```\n\n**SERVICES ARCHITECTURE:**\n- ğŸšª API Gateway: 4000 (Main entry point)\n- ğŸ” Auth Service: 4010 (Gmail OAuth + Wallet)\n- ğŸ“ IPFS Service: 4002 (File upload)\n- ğŸ¢ Admin Service: 4003 (Property mgmt)\n- â›“ï¸ Blockchain Service: 4004 (Smart contracts)\n- ğŸ” Query Service: 4005 (Property search)\n- ğŸ‘¤ User Service: 4006 (User profiles)\n- âœ… KYC Service: 4007 (Identity verification)\n- ğŸ›’ Marketplace Service: 4008 (NFT marketplace)\n- ğŸ“Š Indexer Service: 5000 (Event listener)\n\n**ğŸ¯ COMPLETE TEST WORKFLOW:**\n```\n1. ğŸŒ Login Gmail (Browser) â†’ JWT token\n2. ğŸ“‹ Get user info â†’ Verify authentication\n3. âœ… Submit KYC â†’ Auto-verified\n4. ğŸ’¼ Link wallet (Optional) â†’ Enable transactions\n5. ğŸ  Create property â†’ Property data\n6. ğŸ“· Upload image â†’ IPFS CID\n7. ğŸ“ Generate metadata â†’ IPFS metadata\n8. ğŸ¨ Mint NFT â†’ Blockchain transaction\n9. ğŸ” Query NFTs â†’ ERC721Enumerable (FIXED)\n10. ğŸ’° Create listing â†’ Marketplace listing\n11. âš¡ Browse fast â†’ MongoDB cached data\n12. ğŸ’µ Create offer â†’ Negotiation\n13. âœ… Accept offer â†’ Complete transaction\n```",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "ğŸ“– 0. HÆ°á»›ng Dáº«n Sá»­ Dá»¥ng",
      "item": [
        {
          "name": "README - CÃ¡ch Test API",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:4000/health",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["health"]
            },
            "description": "## ğŸš€ HÆ¯á»šNG DáºªN TEST HYBRID ARCHITECTURE VIEPROPCHAIN\n\n### **ğŸ¯ LUá»’NG TEST HOÃ€N CHá»ˆNH: Login â†’ Marketplace Transaction**\n\n**âœ… ÄÃƒ IMPLEMENT:**\n- ğŸ”¥ **ERC721Enumerable** NFT Query (FIXED)\n- âš¡ **Fast Read APIs** tá»« MongoDB (50ms)\n- ğŸ¯ **Event Indexer** tá»± Ä‘á»™ng sync\n- ğŸ’° **Complete Marketplace** workflow\n\n---\n\n### **ğŸš€ QUICK TEST - NFT Marketplace (3 phÃºt)**\n\n**1. Test Fast Read APIs ngay:**\n```bash\n# Test marketplace homepage (MongoDB fast read)\nGET http://localhost:4008/api/marketplace/home\n\n# Test NFT query vá»›i wallet cÃ³ sáºµn\nGET http://localhost:4008/api/marketplace/my-nfts/0xc6890b26a32d9d92aefbc8635c4588247529cdfe\n\n# Test listing detail\nGET http://localhost:4008/api/marketplace/listings/69060885436f7c5880be62c5\n```\n\n**2. Cháº¡y cÃ¡c folders theo thá»© tá»±:**\n- **ğŸ“Š Fast Read APIs** â†’ Test MongoDB speed\n- **ğŸ”¥ NFT Query Test** â†’ Verify ERC721Enumerable\n- **ğŸ’° Marketplace Demo** â†’ Complete workflow\n\n---\n\n### **ğŸ”§ Services Setup (Required)**\n\n```bash\n# 1. Start Core Services\ncd database_viepropchain_microservice/services/api-gateway\nnpm start  # Port 4000 (REQUIRED)\n\ncd database_viepropchain_microservice/services/marketplace-service\nnpm start  # Port 4008 (REQUIRED)\n\ncd database_viepropchain_microservice/services/blockchain-service\nnpm start  # Port 4004 (REQUIRED)\n\n# 2. Start Indexer (Background)\ncd database_viepropchain_microservice/services/indexer-service\nnpm start  # Port 5000 (Event listener)\n\n# 3. Start Ganache\nganache -m \"arm either chef prosper fish lonely rigid antique dawn stumble wife camera\" --database.dbPath \"./ganache-data-dev\" --chain.networkId 1337 --server.port 8545\n```\n\n**Full Services (for complete workflow):**\n```bash\n# Auth & User\ncd services/auth-service && npm start     # Port 4010\ncd services/user-service && npm start     # Port 4006\ncd services/kyc-service && npm start      # Port 4007\n\n# Property & IPFS\ncd services/admin-service && npm start    # Port 4003\ncd services/ipfs-service && npm start     # Port 4002\ncd services/query-service && npm start    # Port 4005\n```\n\n---\n\n### **ğŸ“± COMPLETE WORKFLOW TESTING**\n\n#### **ğŸ”¥ Phase 1: Authentication & Setup**\n\n**1.1. Gmail Login (BROWSER ONLY)**\n```\nğŸŒ Má»Ÿ browser: http://localhost:4000/api/auth/google\nğŸ“ Login Gmail â†’ Copy JWT token tá»« URL\nğŸ”§ Paste vÃ o Postman Environment: {{jwt_token}}\n```\n\n**1.2. Verify Authentication**\n```\nğŸ“‹ Run: \"Get My Info\"\nâœ… Expected: User data + userId\nğŸ”§ Auto-set: {{user_id}}, {{user_email}}\n```\n\n**1.3. KYC Verification**\n```\nâœ… Run: \"Submit KYC\"\nâš¡ Auto-verified ngay láº­p tá»©c\n```\n\n**1.4. Link Wallet (Optional)**\n```\nğŸ”— Run: \"Get Link Wallet Message\"\nğŸ”§ Generate signature vá»›i Node.js:\n\nconst { ethers } = require('ethers');\nconst PRIVATE_KEY = '0x4f3edf983ac636a65a842ce7c78d9aa706d3b113bce9c46f30d7d21715b23b1d';\nconst wallet = new ethers.Wallet(PRIVATE_KEY);\nconst message = 'Link wallet 0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb2 to account ...';\nwallet.signMessage(message).then(signature => console.log('Signature:', signature));\n\nğŸ’¼ Run: \"Link Wallet\" vá»›i signature\nâœ… Auto-set: {{user_wallet}}\n```\n\n#### **ğŸ”¥ Phase 2: Property & NFT Creation**\n\n**2.1. Create Property**\n```\nğŸ  Run: \"Create Property\"\nâœ… Auto-set: {{property_id}}\n```\n\n**2.2. IPFS Upload**\n```\nğŸ“· Run: \"Upload Image\" (select file)\nâœ… Auto-set: {{image_cid}}\n\nğŸ“ Run: \"Upload Metadata\"\nâœ… Auto-set: {{metadata_cid}}\n```\n\n**2.3. Mint NFT**\n```\nğŸ¨ Run: \"Admin Mint NFT\"\nâœ… Auto-set: {{token_id}}\nâ›“ï¸ Blockchain transaction executed\n```\n\n#### **ğŸ”¥ Phase 3: NFT Query & Verification**\n\n**3.1. Test ERC721Enumerable (FIXED)**\n```\nğŸ” Run: \"ğŸ”¥ Test NFT Query by Wallet\"\nâœ… Expected: NFT array vá»›i tokenId, owner, tokenURI\nğŸ¯ Verify: ERC721Enumerable functions working\n```\n\n**3.2. Verify NFT Ownership**\n```\nğŸ‘¤ Run: \"Get User's NFTs\"\nâœ… Expected: Danh sÃ¡ch NFTs cá»§a wallet\n```\n\n#### **ğŸ”¥ Phase 4: Marketplace Operations**\n\n**4.1. Create Listing**\n```\nğŸ’° Run: \"Create Listing\"\nBody:\n{\n  \"tokenId\": {{token_id}},\n  \"contractAddress\": \"0x4Cf97592f58e9f266BAce5405602c97c9bFc4F48\",\n  \"propertyId\": {{property_id}},\n  \"price\": \"50000000000000000000\",\n  \"description\": \"Beautiful property for sale\"\n}\nâœ… Auto-set: {{listing_id}}\n```\n\n**4.2. Test Fast Read APIs**\n```\nâš¡ Run: \"ğŸš€ Browse Marketplace (Fast)\"\nâœ… Expected: MongoDB response < 100ms\nğŸ” Run: \"ğŸš€ Get Listing Detail (Fast)\"\nâœ… Expected: Enhanced listing data\n```\n\n**4.3. Create & Manage Offers**\n```\nğŸ’µ Run: \"Create Offer\"\nBody:\n{\n  \"listingId\": {{listing_id}},\n  \"price\": \"45000000000000000000\",\n  \"message\": \"Interested in buying\"\n}\nâœ… Auto-set: {{offer_id}}\n\nğŸ‘€ Run: \"Get Offers by Listing\"\nâœ… Expected: List of offers\n\nâœ… Run: \"Accept Offer\" (as seller)\nğŸ¯ Expected: Listing â†’ sold, Offer â†’ accepted\n```\n\n#### **ğŸ”¥ Phase 5: Verify Event Indexing**\n\n**5.1. Check Indexer Sync**\n```\nğŸ“Š Run: \"ğŸš€ Browse Marketplace (Fast)\"\nâœ… Verify: Listing status updated automatically\nâš¡ Check: Event indexer Ä‘Ã£ sync tá»« blockchain\n```\n\n---\n\n### **ğŸ“Š HYBRID ARCHITECTURE BENEFITS**\n\n**âš¡ Performance Comparison:**\n```\nBEFORE (Blockchain Direct):\n- Browse listings: 3-5 seconds\n- Filter/search: Not possible\n- Pagination: Very slow\n\nAFTER (Hybrid MongoDB):\n- Browse listings: 50-100ms (30-50x faster!)\n- Filter/search: Full-text search\n- Pagination: Efficient with large datasets\n```\n\n**ğŸ¯ Key Features:**\n- âœ… **Real-time sync** via event indexer\n- âœ… **Source of truth** váº«n lÃ  blockchain\n- âœ… **Fast reads** tá»« MongoDB\n- âœ… **Rich queries** (filter, sort, search)\n- âœ… **Analytics** (views, favorites)\n\n---\n\n### **ğŸš¨ TROUBLESHOOTING**\n\n**Services Not Starting:**\n```bash\n# Check ports\nnetstat -ano | findstr :4000\nnetstat -ano | findstr :4008\n\n# Kill processes if needed\ntaskkill /PID <pid> /F\n```\n\n**Ganache Issues:**\n```bash\n# Reset blockchain\nrm -rf ./ganache-data-dev\nganache -m \"arm either chef...\" --database.dbPath \"./ganache-data-dev\"\n```\n\n**MongoDB Issues:**\n```bash\n# Check MongoDB connection\nmongo\nshow dbs\nuse viepropchain\ndb.listings.find()\n```\n\n**Event Indexer Not Working:**\n```bash\n# Check indexer logs\ncd services/indexer-service\nnpm start\n# Should show: \"âœ… Marketplace Indexer started\"\n```\n\n---\n\n**ğŸ‰ SUCCESS CRITERIA:**\n1. âœ… Fast marketplace loading (< 100ms)\n2. âœ… NFT query returning complete data\n3. âœ… Listing creation working\n4. âœ… Offer workflow complete\n5. âœ… Real-time sync between blockchain & DB\n\n**ğŸš€ Ready for production-scale NFT marketplace!**"
          }
        }
      ]
    },
    {
      "name": "ğŸ“Š Fast Read APIs (Hybrid Architecture)",
      "item": [
        {
          "name": "ğŸš€ Browse Marketplace (Fast)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Fast marketplace load\", function () {",
                  "    pm.response.to.have.status(200);",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.eql(true);",
                  "    ",
                  "    console.log(\"âš¡ Performance Test Results:\");",
                  "    console.log(\"ğŸ“Š Total Listings: \" + jsonData.data.pagination.total);",
                  "    console.log(\"â±ï¸ Response Time: \" + pm.response.responseTime + \"ms\");",
                  "    console.log(\"ğŸ¯ Expected: < 200ms (vs 3-5s blockchain direct)\");",
                  "    ",
                  "    if (jsonData.data.listings.length > 0) {",
                  "        console.log(\"ğŸ  First Listing: \" + jsonData.data.listings[0].propertyName);",
                  "        console.log(\"ğŸ’° Price: \" + jsonData.data.listings[0].price.formatted);",
                  "        console.log(\"ğŸ“ Location: \" + jsonData.data.listings[0].address.full);",
                  "    }",
                  "    ",
                  "    console.log(\"ğŸ“ˆ Market Stats:\");",
                  "    console.log(\"  - Total Active: \" + jsonData.data.stats.totalListings);",
                  "    console.log(\"  - Total Views: \" + jsonData.data.stats.totalViews);",
                  "    console.log(\"  - Avg Price: \" + (jsonData.data.stats.averagePrice / 1e18).toFixed(2) + \" ETH\");",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:4008/api/marketplace/home?page=1&limit=12&sortBy=listedAt&sortOrder=desc",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4008",
              "path": ["api", "marketplace", "home"],
              "query": [
                {
                  "key": "page",
                  "value": "1",
                  "description": "Page number"
                },
                {
                  "key": "limit",
                  "value": "12",
                  "description": "Items per page"
                },
                {
                  "key": "propertyType",
                  "value": "apartment",
                  "description": "Filter by property type",
                  "disabled": true
                },
                {
                  "key": "city",
                  "value": "TP. Há»“ ChÃ­ Minh",
                  "description": "Filter by city",
                  "disabled": true
                },
                {
                  "key": "minPrice",
                  "value": "10",
                  "description": "Min price in ETH",
                  "disabled": true
                },
                {
                  "key": "maxPrice",
                  "value": "100",
                  "description": "Max price in ETH",
                  "disabled": true
                },
                {
                  "key": "search",
                  "value": "PhÃ²ng",
                  "description": "Search in name/description",
                  "disabled": true
                },
                {
                  "key": "sortBy",
                  "value": "listedAt",
                  "description": "Sort field: listedAt, price.amount, views"
                },
                {
                  "key": "sortOrder",
                  "value": "desc",
                  "description": "asc or desc"
                }
              ]
            },
            "description": "ğŸš€ **HYBRID ARCHITECTURE: Fast Marketplace Homepage**\n\n**âœ… PERFORMANCE BENCHMARK:**\n- **MongoDB Read**: ~50-100ms\n- **Blockchain Direct**: ~3-5 seconds\n- **Improvement**: 30-50x faster!\n\n**ğŸ¯ Features:**\n- âš¡ **Instant loading** tá»« MongoDB cache\n- ğŸ” **Full-text search** trong name/description\n- ğŸ·ï¸ **Advanced filtering** by type, city, price\n- ğŸ“Š **Real-time statistics** & analytics\n- ğŸ“„ **Efficient pagination** vá»›i large datasets\n- ğŸ’± **Auto price formatting** (Wei â†’ ETH)\n\n**ğŸ“Š Enhanced Response:**\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"listings\": [\n      {\n        \"id\": \"listing_id\",\n        \"tokenId\": 1,\n        \"propertyName\": \"PhÃ²ng 1124 E4\",\n        \"propertyType\": \"apartment\",\n        \"address\": {\n          \"city\": \"TP. Há»“ ChÃ­ Minh\",\n          \"full\": \"Máº¡c Äá»‰nh Chi, ÄÃ´ng HÃ²a, TP. Há»“ ChÃ­ Minh\"\n        },\n        \"area\": 150,\n        \"image\": \"/placeholder.jpg\",\n        \"price\": {\n          \"wei\": \"50000000000000000000\",\n          \"eth\": \"50.0000\",\n          \"formatted\": \"50.00 ETH\"\n        },\n        \"seller\": {\n          \"address\": \"0xc689...\",\n          \"shortAddress\": \"0xc689...cdfe\"\n        },\n        \"stats\": {\n          \"views\": 12,\n          \"favorites\": 3\n        },\n        \"timing\": {\n          \"listed\": \"2025-11-01T13:17:57.078Z\",\n          \"daysLeft\": 89\n        }\n      }\n    ],\n    \"pagination\": {\n      \"page\": 1,\n      \"total\": 25,\n      \"pages\": 3,\n      \"hasNext\": true\n    },\n    \"stats\": {\n      \"totalListings\": 25,\n      \"totalViews\": 1247,\n      \"averagePrice\": 45000000000000000000\n    },\n    \"filters\": {\n      \"propertyTypes\": [\"apartment\", \"house\", \"villa\"],\n      \"cities\": [\"TP. Há»“ ChÃ­ Minh\", \"HÃ  Ná»™i\"],\n      \"priceRanges\": [...]\n    }\n  }\n}\n```\n\n**ğŸ”§ Test Filters:**\n- Enable `propertyType=apartment`\n- Enable `city=TP. Há»“ ChÃ­ Minh`  \n- Enable `minPrice=10&maxPrice=100`\n- Enable `search=PhÃ²ng`\n\n**ğŸ¯ Auto-sync tá»« Blockchain Events:**\n- ItemListed â†’ Tá»± Ä‘á»™ng táº¡o listing\n- ItemSold â†’ Tá»± Ä‘á»™ng update status\n- Real-time without manual refresh!"
          }
        },
        {
          "name": "ğŸš€ Get Listing Detail (Fast)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Fast listing detail\", function () {",
                  "    pm.response.to.have.status(200);",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.eql(true);",
                  "    ",
                  "    console.log(\"âš¡ Detail Load Time: \" + pm.response.responseTime + \"ms\");",
                  "    console.log(\"ğŸ  Property: \" + jsonData.data.property.name);",
                  "    console.log(\"ğŸ’° Price: \" + jsonData.data.price.formatted);",
                  "    console.log(\"ğŸ‘¤ Seller: \" + jsonData.data.seller.shortAddress);",
                  "    console.log(\"ğŸ“Š Views: \" + jsonData.data.stats.views + \" (auto-incremented)\");",
                  "    console.log(\"ğŸ”— Contract: \" + jsonData.data.blockchain.contractAddress);",
                  "    console.log(\"â° Days Left: \" + jsonData.data.timing.daysLeft);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:4008/api/marketplace/listings/69060885436f7c5880be62c5",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4008",
              "path": [
                "api",
                "marketplace",
                "listings",
                "69060885436f7c5880be62c5"
              ]
            },
            "description": "ğŸš€ **FAST LISTING DETAIL with View Tracking**\n\n**Features:**\n- âš¡ **Instant load** tá»« MongoDB (vs slow blockchain calls)\n- ğŸ‘ï¸ **Auto view tracking** - increments má»—i láº§n xem\n- ğŸ“Š **Enhanced data** vá»›i formatted prices, timing\n- ğŸ”— **Complete blockchain info** for verification\n- ğŸ’° **Ready-to-use** price formatting\n\n**Enhanced Response:**\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"id\": \"69060885436f7c5880be62c5\",\n    \"tokenId\": 1,\n    \"contractAddress\": \"0x4Cf97592f58e9f266BAce5405602c97c9bFc4F48\",\n    \"property\": {\n      \"name\": \"PhÃ²ng 1124 E4\",\n      \"type\": \"apartment\",\n      \"address\": {...},\n      \"area\": 150,\n      \"description\": \"...\"\n    },\n    \"price\": {\n      \"wei\": \"50000000000000000000\",\n      \"eth\": \"50.0000\",\n      \"formatted\": \"50.00 ETH\",\n      \"usd\": null\n    },\n    \"seller\": {\n      \"walletAddress\": \"0xc6890b26a32d9d92aefbc8635c4588247529cdfe\",\n      \"email\": \"seller@gmail.com\",\n      \"shortAddress\": \"0xc689...cdfe\"\n    },\n    \"stats\": {\n      \"views\": 15,\n      \"favorites\": 3,\n      \"offers\": 2\n    },\n    \"timing\": {\n      \"listed\": \"2025-11-01T13:17:57.078Z\",\n      \"expires\": \"2026-01-30T13:17:57.078Z\",\n      \"daysLeft\": 89,\n      \"isExpired\": false\n    },\n    \"blockchain\": {\n      \"tokenId\": 1,\n      \"contractAddress\": \"0x4Cf97592f58e9f266BAce5405602c97c9bFc4F48\",\n      \"network\": \"Ganache Local\"\n    }\n  }\n}\n```\n\n**ğŸ¯ Use Case:** Frontend detail page hiá»ƒn thá»‹ Ä‘áº§y Ä‘á»§ thÃ´ng tin mÃ  khÃ´ng cáº§n wait blockchain response\n\n**Test vá»›i existing listing ID:** `69060885436f7c5880be62c5`"
          }
        },
        {
          "name": "ğŸš€ Featured Listings",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:4008/api/marketplace/featured?limit=6",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4008",
              "path": ["api", "marketplace", "featured"],
              "query": [
                {
                  "key": "limit",
                  "value": "6",
                  "description": "Number of featured items"
                }
              ]
            },
            "description": "ğŸš€ **FEATURED LISTINGS** - Most Viewed in 7 Days\n\n**Algorithm:**\n- Láº¥y listings Ä‘Æ°á»£c xem nhiá»u nháº¥t trong 7 ngÃ y qua\n- Sáº¯p xáº¿p theo views descending\n- Perfect cho homepage \"Hot Deals\" section\n\n**Use Case:**\n- Homepage featured section\n- \"Trending now\" widget\n- Popular properties showcase"
          }
        },
        {
          "name": "ğŸš€ Search Suggestions",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:4008/api/marketplace/search/suggestions?q=PhÃ²ng",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4008",
              "path": ["api", "marketplace", "search", "suggestions"],
              "query": [
                {
                  "key": "q",
                  "value": "PhÃ²ng",
                  "description": "Search query (min 2 chars)"
                }
              ]
            },
            "description": "ğŸš€ **AUTOCOMPLETE SEARCH SUGGESTIONS**\n\n**Features:**\n- âš¡ Real-time suggestions while typing\n- ğŸ” Search trong property name, city, district\n- ğŸ“Š Aggregated unique suggestions\n- ğŸ¯ Perfect cho search autocomplete UI\n\n**Test queries:**\n- `q=PhÃ²ng` â†’ Property names\n- `q=TP` â†’ Cities\n- `q=Quáº­n` â†’ Districts\n\n**Response:**\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"query\": \"PhÃ²ng\",\n    \"suggestions\": [\n      \"PhÃ²ng 1124 E4\",\n      \"PhÃ²ng Deluxe Quáº­n 1\",\n      \"TP. Há»“ ChÃ­ Minh\",\n      \"Quáº­n 2\"\n    ]\n  }\n}\n```"
          }
        }
      ]
    },
    {
      "name": "âœ… Health Checks",
      "item": [
        {
          "name": "API Gateway Health",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:4000/health",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["health"]
            },
            "description": "Kiá»ƒm tra API Gateway Ä‘ang cháº¡y"
          }
        },
        {
          "name": "Auth Service Health",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:4000/api/auth/health",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "auth", "health"]
            },
            "description": "Kiá»ƒm tra Auth Service"
          }
        },
        {
          "name": "Marketplace Service Health",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:4000/api/marketplace/health",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "marketplace", "health"]
            },
            "description": "Kiá»ƒm tra Marketplace Service"
          }
        }
      ]
    },
    {
      "name": "1ï¸âƒ£ Auth & User",
      "item": [
        {
          "name": "ğŸŒ Login Gmail (Má»Ÿ trong Browser)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:4000/api/auth/google",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "auth", "google"]
            },
            "description": "âš ï¸ **KHÃ”NG CHáº Y REQUEST NÃ€Y TRONG POSTMAN!**\n\n**CÃ¡ch lÃ m:**\n1. Copy URL: http://localhost:4000/api/auth/google\n2. Má»Ÿ **Browser**\n3. Paste URL vÃ  Enter\n4. Chá»n Gmail Ä‘á»ƒ login\n5. Sau khi login, copy JWT token tá»« URL redirect\n6. Paste vÃ o biáº¿n {{jwt_token}}"
          }
        },
        {
          "name": "Get My Info",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Get user info success\", function () {",
                  "    pm.response.to.have.status(200);",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.eql(true);",
                  "    if (jsonData.user && jsonData.user.userId) {",
                  "        pm.environment.set(\"user_id\", jsonData.user.userId);",
                  "        console.log(\"âœ… User ID: \" + jsonData.user.userId);",
                  "    }",
                  "    if (jsonData.user && jsonData.user.email) {",
                  "        pm.environment.set(\"user_email\", jsonData.user.email);",
                  "        console.log(\"ğŸ“§ Email: \" + jsonData.user.email);",
                  "    }",
                  "    if (jsonData.user && jsonData.user.walletAddress) {",
                  "        pm.environment.set(\"user_wallet\", jsonData.user.walletAddress);",
                  "        console.log(\"ğŸ’¼ Wallet: \" + jsonData.user.walletAddress);",
                  "    }",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "http://localhost:4000/api/auth/me",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "auth", "me"]
            },
            "description": "Láº¥y thÃ´ng tin user hiá»‡n táº¡i tá»« JWT token"
          }
        },
        {
          "name": "Logout",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "http://localhost:4000/api/auth/logout",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "auth", "logout"]
            },
            "description": "ÄÄƒng xuáº¥t"
          }
        }
      ]
    },
    {
      "name": "2ï¸âƒ£ KYC",
      "item": [
        {
          "name": "Submit KYC",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"KYC submitted\", function () {",
                  "    pm.response.to.have.status(201);",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.eql(true);",
                  "    console.log(\"âœ… KYC Status: \" + jsonData.kyc.status);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"fullName\": \"Nguyá»…n VÄƒn A\",\n  \"idNumber\": \"123456789012\"\n}"
            },
            "url": {
              "raw": "http://localhost:4000/api/kyc",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "kyc"]
            },
            "description": "Ná»™p KYC Ä‘á»ƒ xÃ¡c minh danh tÃ­nh\n\n**LÆ°u Ã½:**\n- userId vÃ  email láº¥y tá»± Ä‘á»™ng tá»« JWT token\n- KhÃ´ng cáº§n gá»­i walletAddress\n- KYC tá»± Ä‘á»™ng verify ngay"
          }
        },
        {
          "name": "Get My KYC",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "http://localhost:4000/api/kyc/me",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "kyc", "me"]
            },
            "description": "Láº¥y thÃ´ng tin KYC cá»§a tÃ´i"
          }
        },
        {
          "name": "Check Verified Status",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "http://localhost:4000/api/kyc/me/verified",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "kyc", "me", "verified"]
            },
            "description": "Kiá»ƒm tra Ä‘Ã£ verify chÆ°a"
          }
        }
      ]
    },
    {
      "name": "3ï¸âƒ£ Wallet Linking (Optional)",
      "item": [
        {
          "name": "Get Link Wallet Message",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Message generated\", function () {",
                  "    pm.response.to.have.status(200);",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.eql(true);",
                  "    console.log(\"ğŸ“ Message to sign:\");",
                  "    console.log(jsonData.message);",
                  "    console.log(\"\");",
                  "    console.log(\"âš ï¸ DÃ¹ng Node.js script Ä‘á»ƒ generate signature!\");",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"walletAddress\": \"0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb2\"\n}"
            },
            "url": {
              "raw": "http://localhost:4000/api/auth/link-wallet/message",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "auth", "link-wallet", "message"]
            },
            "description": "Láº¥y message Ä‘á»ƒ kÃ½ báº±ng private key\n\n**Wallet tá»« Ganache:**\n- Address: 0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb2\n- Private Key: 0x4f3edf983ac636a65a842ce7c78d9aa706d3b113bce9c46f30d7d21715b23b1d\n\n**Sau khi cÃ³ message, dÃ¹ng file `generate-wallet-signature.js` Ä‘á»ƒ táº¡o signature**"
          }
        },
        {
          "name": "Link Wallet",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Wallet linked\", function () {",
                  "    pm.response.to.have.status(200);",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.eql(true);",
                  "    if (jsonData.user && jsonData.user.walletAddress) {",
                  "        pm.environment.set(\"user_wallet\", jsonData.user.walletAddress);",
                  "        console.log(\"âœ… Wallet linked: \" + jsonData.user.walletAddress);",
                  "    }",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"walletAddress\": \"0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb2\",\n  \"signature\": \"0x...(paste signature tá»« Node.js script)\"\n}"
            },
            "url": {
              "raw": "http://localhost:4000/api/auth/link-wallet",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "auth", "link-wallet"]
            },
            "description": "Link wallet sau khi cÃ³ signature\n\n**CÃ¡ch generate signature:**\n\n1. Táº¡o file `generate-wallet-signature.js`\n2. Paste code tá»« README\n3. Cháº¡y: node generate-wallet-signature.js\n4. Copy signature\n5. Paste vÃ o body request nÃ y"
          }
        },
        {
          "name": "Unlink Wallet",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "http://localhost:4000/api/auth/unlink-wallet",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "auth", "unlink-wallet"]
            },
            "description": "Gá»¡ wallet khá»i tÃ i khoáº£n"
          }
        }
      ]
    },
    {
      "name": "4ï¸âƒ£ Property",
      "item": [
        {
          "name": "Create Property",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Property created\", function () {",
                  "    pm.response.to.have.status(201);",
                  "    var jsonData = pm.response.json();",
                  "    if (jsonData.data && jsonData.data._id) {",
                  "        pm.environment.set(\"property_id\", jsonData.data._id);",
                  "        console.log(\"âœ… Property ID: \" + jsonData.data._id);",
                  "    }",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Biá»‡t Thá»± Cao Cáº¥p Quáº­n 2\",\n  \"description\": \"Biá»‡t thá»± 3 phÃ²ng ngá»§ cÃ³ há»“ bÆ¡i vÃ  vÆ°á»n\",\n  \"propertyType\": \"villa\",\n  \"address\": {\n    \"street\": \"123 Tháº£o Äiá»n\",\n    \"ward\": \"Tháº£o Äiá»n\",\n    \"district\": \"Quáº­n 2\",\n    \"city\": \"TP. Há»“ ChÃ­ Minh\",\n    \"country\": \"Viá»‡t Nam\"\n  },\n  \"area\": 250,\n  \"price\": 15000000000,\n  \"currency\": \"VND\",\n  \"bedrooms\": 3,\n  \"bathrooms\": 3,\n  \"features\": [\"Há»“ BÆ¡i\", \"VÆ°á»n\", \"BÃ£i Äáº­u Xe\", \"An Ninh 24/7\"],\n  \"owner\": \"{{user_id}}\",\n  \"legalStatus\": \"verified\"\n}"
            },
            "url": {
              "raw": "http://localhost:4000/api/admin/properties",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "admin", "properties"]
            },
            "description": "Táº¡o property má»›i\n\n**LÆ°u Ã½:** owner = user_id (khÃ´ng pháº£i wallet)"
          }
        },
        {
          "name": "Get Property Detail",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:4000/api/admin/properties/{{property_id}}",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "admin", "properties", "{{property_id}}"]
            },
            "description": "Xem chi tiáº¿t property"
          }
        },
        {
          "name": "Get All Properties",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:4000/api/admin/properties",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "admin", "properties"]
            },
            "description": "Danh sÃ¡ch táº¥t cáº£ properties"
          }
        },
        {
          "name": "Search Properties",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:4000/api/query/properties?city=TP. Há»“ ChÃ­ Minh&propertyType=villa",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "query", "properties"],
              "query": [
                {
                  "key": "city",
                  "value": "TP. Há»“ ChÃ­ Minh"
                },
                {
                  "key": "propertyType",
                  "value": "villa"
                }
              ]
            },
            "description": "TÃ¬m kiáº¿m properties"
          }
        }
      ]
    },
    {
      "name": "5ï¸âƒ£ IPFS Upload",
      "item": [
        {
          "name": "Upload Image",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Image uploaded\", function () {",
                  "    pm.response.to.have.status(200);",
                  "    var jsonData = pm.response.json();",
                  "    if (jsonData.cid) {",
                  "        pm.environment.set(\"image_cid\", jsonData.cid);",
                  "        console.log(\"âœ… Image CID: \" + jsonData.cid);",
                  "    }",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "file",
                  "type": "file",
                  "src": [],
                  "description": "Chá»n file áº£nh á»Ÿ Ä‘Ã¢y"
                }
              ]
            },
            "url": {
              "raw": "http://localhost:4000/api/ipfs/upload/image",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "ipfs", "upload", "image"]
            },
            "description": "Upload áº£nh lÃªn IPFS\n\nâš ï¸ Chá»n file trong Body â†’ form-data â†’ file"
          }
        },
        {
          "name": "Upload Metadata",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Metadata uploaded\", function () {",
                  "    pm.response.to.have.status(200);",
                  "    var jsonData = pm.response.json();",
                  "    if (jsonData.cid) {",
                  "        pm.environment.set(\"metadata_cid\", jsonData.cid);",
                  "        console.log(\"âœ… Metadata CID: \" + jsonData.cid);",
                  "    }",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"propertyId\": \"{{property_id}}\",\n  \"imageCID\": \"{{image_cid}}\"\n}"
            },
            "url": {
              "raw": "http://localhost:4000/api/ipfs/upload/metadata",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "ipfs", "upload", "metadata"]
            },
            "description": "Auto-generate metadata tá»« property data"
          }
        },
        {
          "name": "Get Metadata Content",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:4000/api/ipfs/content/{{metadata_cid}}",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "ipfs", "content", "{{metadata_cid}}"]
            },
            "description": "Xem ná»™i dung metadata JSON"
          }
        }
      ]
    },
    {
      "name": "6ï¸âƒ£ NFT Minting",
      "item": [
        {
          "name": "Admin Mint NFT",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"NFT minted\", function () {",
                  "    pm.response.to.have.status(200);",
                  "    var jsonData = pm.response.json();",
                  "    if (jsonData.tokenId) {",
                  "        pm.environment.set(\"token_id\", jsonData.tokenId);",
                  "        console.log(\"âœ… Token ID: \" + jsonData.tokenId);",
                  "        console.log(\"ğŸ“œ Tx Hash: \" + jsonData.transactionHash);",
                  "    }",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"recipient\": \"{{user_wallet}}\",\n  \"tokenURI\": \"ipfs://{{metadata_cid}}\"\n}"
            },
            "url": {
              "raw": "http://localhost:4000/api/blockchain/mint",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "blockchain", "mint"]
            },
            "description": "Admin mint NFT cho user\n\n**YÃªu cáº§u:** User Ä‘Ã£ link wallet"
          }
        },
        {
          "name": "Verify NFT Ownership",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:4000/api/blockchain/nft/{{token_id}}",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "blockchain", "nft", "{{token_id}}"]
            },
            "description": "Kiá»ƒm tra owner cá»§a NFT"
          }
        },
        {
          "name": "Get User's NFTs",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:4000/api/blockchain/nfts/{{user_wallet}}",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "blockchain", "nfts", "{{user_wallet}}"]
            },
            "description": "Danh sÃ¡ch NFT cá»§a user"
          }
        }
      ]
    },
    {
      "name": "6ï¸âƒ£.1 NFT Info Helper",
      "item": [
        {
          "name": "ğŸ”¥ Test NFT Query by Wallet",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"NFT query success\", function () {",
                  "    pm.response.to.have.status(200);",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.eql(true);",
                  "    console.log(\"ğŸ‘¤ Owner: \" + jsonData.data.owner);",
                  "    console.log(\"ğŸ”¢ Balance: \" + jsonData.data.balance);",
                  "    console.log(\"ğŸ“‹ NFTs Count: \" + jsonData.data.nfts.length);",
                  "    if (jsonData.data.nfts.length > 0) {",
                  "        console.log(\"ğŸ¯ First NFT Token ID: \" + jsonData.data.nfts[0].tokenId);",
                  "        console.log(\"ğŸ”— Token URI: \" + jsonData.data.nfts[0].tokenURI);",
                  "        pm.environment.set(\"found_token_id\", jsonData.data.nfts[0].tokenId);",
                  "    }",
                  "    if (jsonData.data.summary) {",
                  "        console.log(\"ğŸ“Š Summary - Total: \" + jsonData.data.summary.total);",
                  "        console.log(\"ğŸ“Š Summary - Ready to List: \" + jsonData.data.summary.readyToList);",
                  "    }",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:4000/api/marketplace/my-nfts/0xc6890b26a32d9d92aefbc8635c4588247529cdfe",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": [
                "api",
                "marketplace",
                "my-nfts",
                "0xc6890b26a32d9d92aefbc8635c4588247529cdfe"
              ]
            },
            "description": "ğŸ§ª **TEST: NFT Query with Fixed Wallet**\n\n**Wallet Ä‘Æ°á»£c test:** `0xc6890b26a32d9d92aefbc8635c4588247529cdfe`\n\n**Expected Result:**\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"owner\": \"0xc6890b26a32d9d92aefbc8635c4588247529cdfe\",\n    \"balance\": 1,\n    \"nfts\": [\n      {\n        \"tokenId\": 1,\n        \"owner\": \"0xc6890b26a32d9d92aefbc8635c4588247529cdfe\",\n        \"tokenURI\": \"ipfs://QmRctQ4FLBgstfGyLDUVdNsai8vTzM3xjykQ42xUi18Nfa\",\n        \"index\": 0,\n        \"metadata\": null,\n        \"property\": null,\n        \"readyToList\": false,\n        \"hasMetadata\": false\n      }\n    ],\n    \"summary\": {\n      \"total\": 1,\n      \"readyToList\": 0,\n      \"withMetadata\": 0,\n      \"withProperty\": 0\n    }\n  }\n}\n```\n\n**âœ… Fixed Issues:**\n- ERC721Enumerable functions working\n- Contract ABI updated with tokenOfOwnerByIndex\n- Blockchain service returns NFT array\n- Marketplace service enhances data properly\n\n**Ready for marketplace listing!**"
          }
        },
        {
          "name": "Get My NFTs with Property Info",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:4000/api/marketplace/my-nfts/{{user_wallet}}",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "marketplace", "my-nfts", "{{user_wallet}}"]
            },
            "description": "ğŸ”¥ **NEW: ERC721Enumerable Feature**\n\n**ğŸ¯ Endpoint quan trá»ng trÆ°á»›c khi list NFT!**\n\nLáº¥y táº¥t cáº£ NFTs cá»§a user thÃ´ng qua wallet address vá»›i thÃ´ng tin chi tiáº¿t:\n- Metadata Ä‘áº§y Ä‘á»§ tá»« IPFS\n- Property information\n- Ready-to-list status\n- Summary statistics\n\n**âœ… FIXED: BÃ¢y giá» Ä‘Ã£ hoáº¡t Ä‘á»™ng vá»›i ERC721Enumerable!**\n\n**Response Enhanced:**\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"owner\": \"0xc6890b26a32d9d92aefbc8635c4588247529cdfe\",\n    \"balance\": 1,\n    \"nfts\": [\n      {\n        \"tokenId\": 1,\n        \"owner\": \"0xc6890b26a32d9d92aefbc8635c4588247529cdfe\",\n        \"tokenURI\": \"ipfs://QmRctQ4FLBgstfGyLDUVdNsai8vTzM3xjykQ42xUi18Nfa\",\n        \"index\": 0,\n        \"metadata\": null,\n        \"property\": null,\n        \"readyToList\": false,\n        \"hasMetadata\": false\n      }\n    ],\n    \"summary\": {\n      \"total\": 1,\n      \"readyToList\": 0,\n      \"withMetadata\": 0,\n      \"withProperty\": 0\n    }\n  }\n}\n```\n\n**Test vá»›i wallet address cá»¥ thá»ƒ:**\n- `0xc6890b26a32d9d92aefbc8635c4588247529cdfe` (Ä‘Ã£ cÃ³ 1 NFT)\n- Hoáº·c thay báº±ng {{user_wallet}} náº¿u Ä‘Ã£ link wallet\n\n**Workflow Ä‘á»ƒ cÃ³ NFT:**\n1. Táº¡o property â†’ mint NFT\n2. Hoáº·c dÃ¹ng wallet address Ä‘Ã£ cÃ³ sáºµn NFT\n\n**YÃªu cáº§u:** wallet address há»£p lá»‡"
          }
        },
        {
          "name": "Get NFT Detail by Token ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:4000/api/marketplace/nft-detail/{{token_id}}",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "marketplace", "nft-detail", "{{token_id}}"]
            },
            "description": "ğŸ”¥ **NEW: Enhanced NFT Detail**\n\nLáº¥y thÃ´ng tin chi tiáº¿t 1 NFT vá»›i:\n- Full metadata\n- Property details\n- Owner information\n- Listing readiness\n\n**DÃ¹ng Ä‘á»ƒ:**\n- Verify NFT trÆ°á»›c khi táº¡o listing\n- Xem Ä‘áº§y Ä‘á»§ thÃ´ng tin property\n- Check ownership"
          }
        },
        {
          "name": "Browse All NFTs (Paginated)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:4000/api/marketplace/all-nfts?page=1&limit=10",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "marketplace", "all-nfts"],
              "query": [
                {
                  "key": "page",
                  "value": "1",
                  "description": "Page number (default: 1)"
                },
                {
                  "key": "limit",
                  "value": "10",
                  "description": "Items per page (default: 20)"
                }
              ]
            },
            "description": "ğŸ”¥ **NEW: Browse All NFTs**\n\nBrowse táº¥t cáº£ NFTs Ä‘Ã£ mint vá»›i pagination:\n- Metadata preview\n- Owner information\n- Efficient pagination\n- Total count & pages\n\n**Response:**\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"nfts\": [...],\n    \"pagination\": {\n      \"currentPage\": 1,\n      \"totalPages\": 5,\n      \"totalItems\": 50,\n      \"itemsPerPage\": 10,\n      \"hasNext\": true,\n      \"hasPrev\": false\n    }\n  }\n}\n```"
          }
        },
        {
          "name": "Get NFTs by Owner (Legacy)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:4000/api/marketplace/nft-info/{{user_wallet}}",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "marketplace", "nft-info", "{{user_wallet}}"]
            },
            "description": "âš ï¸ **LEGACY ENDPOINT** - Sá»­ dá»¥ng /my-nfts/ thay tháº¿\n\nEndpoint cÅ©, redirect tá»›i /my-nfts/\nSá»­ dá»¥ng endpoint má»›i Ä‘á»ƒ cÃ³ performance tá»‘t hÆ¡n"
          }
        }
      ]
    },
    {
      "name": "6ï¸âƒ£.2 ERC721Enumerable Direct (Blockchain Service)",
      "item": [
        {
          "name": "Get Total Supply",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:4000/api/blockchain/total-supply",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "blockchain", "total-supply"]
            },
            "description": "ğŸ”¥ **ERC721Enumerable: Total Supply**\n\nLáº¥y tá»•ng sá»‘ NFTs Ä‘Ã£ mint thÃ´ng qua ERC721Enumerable.totalSupply()\n\n**Response:**\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"totalSupply\": 5,\n    \"totalMinted\": 5\n  }\n}\n```\n\n**Sá»­ dá»¥ng Ä‘á»ƒ:**\n- Kiá»ƒm tra cÃ³ bao nhiÃªu NFTs Ä‘Ã£ Ä‘Æ°á»£c mint\n- Validate pagination parameters\n- Statistics dashboard"
          }
        },
        {
          "name": "Get All NFTs (Raw)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:4000/api/blockchain/all-nfts",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "blockchain", "all-nfts"]
            },
            "description": "ğŸ”¥ **ERC721Enumerable: All NFTs**\n\nLáº¥y táº¥t cáº£ NFTs thÃ´ng qua tokenByIndex() loop\n\n**Response:**\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"totalSupply\": 5,\n    \"nfts\": [\n      {\n        \"tokenId\": 1,\n        \"owner\": \"0x...\",\n        \"tokenURI\": \"ipfs://...\",\n        \"globalIndex\": 0\n      },\n      {\n        \"tokenId\": 2,\n        \"owner\": \"0x...\",\n        \"tokenURI\": \"ipfs://...\",\n        \"globalIndex\": 1\n      }\n    ],\n    \"contractAddress\": \"0x4Cf97592f58e9f266BAce5405602c97c9bFc4F48\"\n  }\n}\n```\n\n**LÆ°u Ã½:**\n- KhÃ´ng cÃ³ pagination (raw data)\n- Sá»­ dá»¥ng marketplace endpoint Ä‘á»ƒ cÃ³ pagination"
          }
        },
        {
          "name": "Get NFTs by Owner (Enhanced)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:4000/api/blockchain/nfts/{{user_wallet}}",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "blockchain", "nfts", "{{user_wallet}}"]
            },
            "description": "ğŸ”¥ **ERC721Enumerable: NFTs by Owner - FIXED!**\n\nLáº¥y NFTs cá»§a owner thÃ´ng qua tokenOfOwnerByIndex() loop\n\n**âœ… Now Working! Enhanced Response:**\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"owner\": \"0xc6890b26a32d9d92aefbc8635c4588247529cdfe\",\n    \"balance\": 1,\n    \"nfts\": [\n      {\n        \"tokenId\": 1,\n        \"owner\": \"0xc6890b26a32d9d92aefbc8635c4588247529cdfe\",\n        \"tokenURI\": \"ipfs://QmRctQ4FLBgstfGyLDUVdNsai8vTzM3xjykQ42xUi18Nfa\",\n        \"index\": 0\n      }\n    ],\n    \"contractAddress\": \"0x4Cf97592f58e9f266BAce5405602c97c9bFc4F48\"\n  }\n}\n```\n\n**Fixed Issues:**\n- âœ… Contract ABI updated with ERC721Enumerable functions\n- âœ… tokenOfOwnerByIndex() now working\n- âœ… Returns complete NFT array instead of just balance\n- âœ… Proper workflow: balanceOf â†’ tokenOfOwnerByIndex â†’ tokenURI\n\n**Test vá»›i wallet cÃ³ NFT:**\n- `0xc6890b26a32d9d92aefbc8635c4588247529cdfe` (balance: 1)\n- Hoáº·c {{user_wallet}} náº¿u Ä‘Ã£ mint NFT"
          }
        },
        {
          "name": "Get NFT by Global Index",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:4000/api/blockchain/nft-by-index/0",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "blockchain", "nft-by-index", "0"]
            },
            "description": "ğŸ”¥ **ERC721Enumerable: NFT by Index**\n\nLáº¥y NFT theo global index thÃ´ng qua tokenByIndex()\n\n**Thay Ä‘á»•i sá»‘ 0 thÃ nh index khÃ¡c Ä‘á»ƒ test**\n\n**Response:**\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"tokenId\": 1,\n    \"owner\": \"0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb2\",\n    \"tokenURI\": \"ipfs://QmabcD...\",\n    \"globalIndex\": 0,\n    \"contractAddress\": \"0x4Cf97592f58e9f266BAce5405602c97c9bFc4F48\"\n  }\n}\n```\n\n**Sá»­ dá»¥ng Ä‘á»ƒ:**\n- Browse NFTs theo index\n- Implement pagination manually\n- Random NFT selection"
          }
        }
      ]
    },
    {
      "name": "7ï¸âƒ£ Marketplace - Listings (Enhanced)",
      "item": [
        {
          "name": "ğŸ”¥ Create Listing (Test vá»›i NFT cÃ³ sáºµn)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Listing created successfully\", function () {",
                  "    pm.response.to.have.status(201);",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.eql(true);",
                  "    if (jsonData.data && jsonData.data._id) {",
                  "        pm.environment.set(\"listing_id\", jsonData.data._id);",
                  "        console.log(\"âœ… Listing ID: \" + jsonData.data._id);",
                  "        console.log(\"ğŸ’° Price: \" + jsonData.data.price.amount + \" wei\");",
                  "        console.log(\"ğŸ  Property: \" + jsonData.data.propertyName);",
                  "        console.log(\"ğŸ‘¤ Seller: \" + jsonData.data.seller.walletAddress);",
                  "    }",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"tokenId\": 1,\n  \"contractAddress\": \"0x4Cf97592f58e9f266BAce5405602c97c9bFc4F48\",\n  \"propertyId\": \"6905c41423f8d019f2eb2ad6\",\n  \"price\": \"75000000000000000000\",\n  \"description\": \"ğŸ”¥ ENHANCED: Beautiful apartment vá»›i Ä‘áº§y Ä‘á»§ thÃ´ng tin property\"\n}"
            },
            "url": {
              "raw": "http://localhost:4000/api/marketplace/listings",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "marketplace", "listings"]
            },
            "description": "ğŸ”¥ **ENHANCED LISTING CREATION**\n\n**âœ… Test vá»›i data cÃ³ sáºµn:**\n- **TokenId**: 1 (Ä‘Ã£ cÃ³ sáºµn)\n- **Contract**: 0x4Cf97592f58e9f266BAce5405602c97c9bFc4F48\n- **PropertyId**: 6905c41423f8d019f2eb2ad6 (existing)\n- **Price**: 75 ETH (75000000000000000000 wei)\n\n**ğŸ¯ Enhanced Features:**\n- âœ… **NFT Ownership Verification** tá»« blockchain\n- âœ… **Property Data Integration** tá»« Admin Service\n- âœ… **Auto-populate** property name, type, address\n- âœ… **Wallet Address Validation**\n- âœ… **Duplicate Listing Prevention**\n\n**Requirements:**\n- ğŸ” Must be logged in (JWT token)\n- ğŸ’¼ Must have wallet linked\n- ğŸ¨ Must own the NFT\n- ğŸ  Property must exist\n\n**Response Enhanced:**\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"_id\": \"listing_id\",\n    \"tokenId\": 1,\n    \"contractAddress\": \"0x4Cf97592f58e9f266BAce5405602c97c9bFc4F48\",\n    \"propertyId\": \"6905c41423f8d019f2eb2ad6\",\n    \"propertyName\": \"PhÃ²ng 1124 E4\",\n    \"propertyType\": \"apartment\",\n    \"propertyAddress\": {\n      \"city\": \"TP. Há»“ ChÃ­ Minh\",\n      \"district\": \"ÄÃ´ng HÃ²a\",\n      \"ward\": \"Máº¡c Äá»‰nh Chi\"\n    },\n    \"propertyArea\": 150,\n    \"seller\": {\n      \"walletAddress\": \"0xc6890b26a32d9d92aefbc8635c4588247529cdfe\",\n      \"email\": \"seller@gmail.com\"\n    },\n    \"price\": {\n      \"amount\": \"75000000000000000000\",\n      \"currency\": \"ETH\"\n    },\n    \"status\": \"active\",\n    \"listedAt\": \"2025-11-01T...\",\n    \"expiresAt\": \"2026-01-30T...\"\n  }\n}\n```\n\n**ğŸš€ Workflow sau khi create:**\n1. âœ… Listing created trong MongoDB\n2. âš¡ Visible ngay trÃªn fast read APIs\n3. ğŸ“Š Auto-indexed for search & filter\n4. ğŸ”„ Ready for offers & transactions"
          }
        },
        {
          "name": "Browse Listings (Legacy - Use Fast APIs)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:4000/api/marketplace/listings?page=1&limit=20&sortBy=listedAt&sortOrder=desc",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "marketplace", "listings"],
              "query": [
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "20"
                },
                {
                  "key": "propertyType",
                  "value": "villa",
                  "disabled": true
                },
                {
                  "key": "city",
                  "value": "TP. Há»“ ChÃ­ Minh",
                  "disabled": true
                },
                {
                  "key": "minPrice",
                  "value": "1000000000000000000",
                  "disabled": true,
                  "description": "Wei"
                },
                {
                  "key": "maxPrice",
                  "value": "5000000000000000000",
                  "disabled": true,
                  "description": "Wei"
                },
                {
                  "key": "sortBy",
                  "value": "listedAt"
                },
                {
                  "key": "sortOrder",
                  "value": "desc"
                }
              ]
            },
            "description": "âš ï¸ **LEGACY ENDPOINT** - Use Fast Read APIs instead!\n\n**Recommended:** Use **ğŸ“Š Fast Read APIs â†’ ğŸš€ Browse Marketplace (Fast)**\n\n**Performance:**\n- This endpoint: ~500ms-1s\n- Fast API: ~50-100ms (5-10x faster)\n\n**Enhanced features in Fast API:**\n- Better price formatting\n- Enhanced search\n- Market statistics\n- Optimized queries"
          }
        },
        {
          "name": "Get Listing Detail (Legacy)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:4000/api/marketplace/listings/{{listing_id}}",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "marketplace", "listings", "{{listing_id}}"]
            },
            "description": "âš ï¸ **LEGACY** - Use Fast Read API instead:\n\n**Recommended:** **ğŸ“Š Fast Read APIs â†’ ğŸš€ Get Listing Detail (Fast)**"
          }
        },
        {
          "name": "Get Listing by Token ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:4000/api/marketplace/listings/token/{{token_id}}",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": [
                "api",
                "marketplace",
                "listings",
                "token",
                "{{token_id}}"
              ]
            },
            "description": "ğŸ” Find listing by NFT token ID\n\n**Use Case:** Check if an NFT is already listed before creating new listing"
          }
        },
        {
          "name": "Update Listing",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"price\": \"80000000000000000000\",\n  \"description\": \"ğŸ”¥ PRICE UPDATE: Reduced to 80 ETH for quick sale!\"\n}"
            },
            "url": {
              "raw": "http://localhost:4000/api/marketplace/listings/{{listing_id}}",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "marketplace", "listings", "{{listing_id}}"]
            },
            "description": "âœï¸ **UPDATE LISTING** (Only seller)\n\n**Editable Fields:**\n- `price`: New price in wei\n- `description`: Updated description\n- `expiresAt`: New expiration date\n\n**Restrictions:**\n- Only active listings\n- Only listing owner\n- Cannot change tokenId/property"
          }
        },
        {
          "name": "Cancel Listing",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "http://localhost:4000/api/marketplace/listings/{{listing_id}}",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "marketplace", "listings", "{{listing_id}}"]
            },
            "description": "âŒ **CANCEL LISTING** (Only seller)\n\n**Effects:**\n- Listing status â†’ cancelled\n- Removed from active listings\n- All pending offers â†’ cancelled\n- NFT ownership remains with seller"
          }
        },
        {
          "name": "Get My Listings",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "http://localhost:4000/api/marketplace/listings/my/listings?status=active",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "marketplace", "listings", "my", "listings"],
              "query": [
                {
                  "key": "status",
                  "value": "active",
                  "description": "active, sold, cancelled, or omit for all"
                }
              ]
            },
            "description": "ğŸ“‹ **MY LISTINGS** - Seller Dashboard\n\n**Filter by status:**\n- `active`: Currently listed\n- `sold`: Successfully sold\n- `cancelled`: Cancelled by seller\n- No filter: All my listings\n\n**Use Case:** Seller management dashboard"
          }
        },
        {
          "name": "Track View (Analytics)",
          "request": {
            "method": "POST",
            "header": [],
            "url": {
              "raw": "http://localhost:4000/api/marketplace/listings/{{listing_id}}/view",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": [
                "api",
                "marketplace",
                "listings",
                "{{listing_id}}",
                "view"
              ]
            },
            "description": "ğŸ‘ï¸ **TRACK VIEW** - Analytics\n\n**Auto-called by:**\n- Listing detail page loads\n- Search result clicks\n- Featured listing views\n\n**Effect:** Increments view counter for popularity ranking"
          }
        }
      ]
    },
    {
      "name": "8ï¸âƒ£ Marketplace - Offers (Complete Workflow)",
      "item": [
        {
          "name": "ğŸ”¥ Create Offer (Enhanced)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Offer created successfully\", function () {",
                  "    pm.response.to.have.status(201);",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.eql(true);",
                  "    if (jsonData.data && jsonData.data._id) {",
                  "        pm.environment.set(\"offer_id\", jsonData.data._id);",
                  "        console.log(\"âœ… Offer ID: \" + jsonData.data._id);",
                  "        console.log(\"ğŸ’° Offer Price: \" + jsonData.data.price.amount + \" wei\");",
                  "        console.log(\"ğŸ“‹ Listing ID: \" + jsonData.data.listingId);",
                  "        console.log(\"ğŸ‘¤ Buyer: \" + jsonData.data.buyer.walletAddress);",
                  "        console.log(\"ğŸ’¬ Message: \" + jsonData.data.message);",
                  "        console.log(\"â° Expires: \" + jsonData.data.expiresAt);",
                  "    }",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"listingId\": \"69060885436f7c5880be62c5\",\n  \"price\": \"70000000000000000000\",\n  \"message\": \"ğŸ”¥ ENHANCED OFFER: I'm very interested in this property. Can we negotiate the price? I can close quickly.\"\n}"
            },
            "url": {
              "raw": "http://localhost:4000/api/marketplace/offers",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "marketplace", "offers"]
            },
            "description": "ğŸ”¥ **ENHANCED OFFER CREATION**\n\n**âœ… Test vá»›i existing listing:**\n- **Listing ID**: 69060885436f7c5880be62c5 (PhÃ²ng 1124 E4)\n- **Original Price**: 50 ETH\n- **Offer Price**: 70 ETH (higher offer)\n- **Auto-expires**: 7 days from creation\n\n**ğŸ¯ Enhanced Features:**\n- âœ… **Listing Validation**: Ensures listing exists & active\n- âœ… **Self-offer Prevention**: Cannot offer on own listings\n- âœ… **Wallet Verification**: Must have linked wallet\n- âœ… **Auto-expiration**: 7 days default\n- âœ… **Message Support**: Negotiation messages\n\n**Requirements:**\n- ğŸ” Must be logged in (JWT token)\n- ğŸ’¼ Must have wallet linked (different from seller)\n- ğŸ¯ Listing must be active\n- ğŸ’° Price must be > 0\n\n**Enhanced Response:**\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"_id\": \"offer_id\",\n    \"listingId\": \"69060885436f7c5880be62c5\",\n    \"tokenId\": 1,\n    \"buyer\": {\n      \"userId\": \"user_id\",\n      \"walletAddress\": \"0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb2\",\n      \"email\": \"buyer@gmail.com\",\n      \"name\": \"Buyer Name\"\n    },\n    \"price\": {\n      \"amount\": \"70000000000000000000\",\n      \"currency\": \"ETH\"\n    },\n    \"message\": \"Enhanced offer message...\",\n    \"status\": \"pending\",\n    \"expiresAt\": \"2025-11-08T...\",\n    \"createdAt\": \"2025-11-01T...\"\n  }\n}\n```\n\n**ğŸ”„ Next Steps:**\n1. âœ… Offer created & visible to seller\n2. ğŸ”” Seller receives notification\n3. âš¡ Available in seller's offers dashboard\n4. ğŸ’° Ready for accept/reject workflow"
          }
        },
        {
          "name": "ğŸ‘€ Get Offers by Listing (Seller View)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Offers retrieved\", function () {",
                  "    pm.response.to.have.status(200);",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.eql(true);",
                  "    ",
                  "    console.log(\"ğŸ“Š Total Offers: \" + jsonData.data.length);",
                  "    ",
                  "    if (jsonData.data.length > 0) {",
                  "        jsonData.data.forEach((offer, index) => {",
                  "            console.log(`\\nğŸ”¸ Offer ${index + 1}:`);",
                  "            console.log(`  ğŸ’° Price: ${(offer.price.amount / 1e18).toFixed(2)} ETH`);",
                  "            console.log(`  ğŸ‘¤ Buyer: ${offer.buyer.walletAddress.slice(0,6)}...${offer.buyer.walletAddress.slice(-4)}`);",
                  "            console.log(`  ğŸ“§ Email: ${offer.buyer.email || 'N/A'}`);",
                  "            console.log(`  ğŸ“ Status: ${offer.status}`);",
                  "            console.log(`  ğŸ’¬ Message: ${offer.message || 'No message'}`);",
                  "            console.log(`  â° Expires: ${new Date(offer.expiresAt).toLocaleDateString()}`);",
                  "        });",
                  "    }",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "http://localhost:4000/api/marketplace/offers/listing/69060885436f7c5880be62c5?status=pending",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": [
                "api",
                "marketplace",
                "offers",
                "listing",
                "69060885436f7c5880be62c5"
              ],
              "query": [
                {
                  "key": "status",
                  "value": "pending",
                  "description": "pending, accepted, rejected, cancelled, expired"
                }
              ]
            },
            "description": "ğŸ‘€ **SELLER DASHBOARD: View All Offers**\n\n**ğŸ¯ Test vá»›i listing cÃ³ sáºµn:**\n- **Listing**: 69060885436f7c5880be62c5\n- **Property**: PhÃ²ng 1124 E4\n\n**ğŸ“Š Enhanced Response:**\n```json\n{\n  \"success\": true,\n  \"data\": [\n    {\n      \"_id\": \"offer_id\",\n      \"listingId\": \"69060885436f7c5880be62c5\",\n      \"buyer\": {\n        \"walletAddress\": \"0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb2\",\n        \"email\": \"buyer@gmail.com\",\n        \"name\": \"John Doe\"\n      },\n      \"price\": {\n        \"amount\": \"70000000000000000000\",\n        \"currency\": \"ETH\"\n      },\n      \"message\": \"Very interested, can close quickly\",\n      \"status\": \"pending\",\n      \"expiresAt\": \"2025-11-08T...\",\n      \"createdAt\": \"2025-11-01T...\"\n    }\n  ]\n}\n```\n\n**ğŸ”§ Filter Options:**\n- `status=pending`: Awaiting decision\n- `status=accepted`: Accepted offers\n- `status=rejected`: Rejected offers\n- No filter: All offers\n\n**ğŸ’¡ Use Case:** Seller management dashboard to review & decide on offers"
          }
        },
        {
          "name": "ğŸ’¼ Get My Offers (Buyer Dashboard)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "http://localhost:4000/api/marketplace/offers/my/offers?status=pending",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "marketplace", "offers", "my", "offers"],
              "query": [
                {
                  "key": "status",
                  "value": "pending",
                  "description": "pending, accepted, rejected, cancelled, expired"
                }
              ]
            },
            "description": "ğŸ’¼ **BUYER DASHBOARD: My Offers Tracking**\n\n**ğŸ“Š Track Status:**\n- `pending`: Waiting for seller response\n- `accepted`: Offer accepted (proceed to payment)\n- `rejected`: Offer declined\n- `cancelled`: Cancelled by me\n- `expired`: Offer expired\n\n**Use Case:** Buyer dashboard to track offer status & take action"
          }
        },
        {
          "name": "ğŸ“¨ Get Offers Received (Seller Dashboard)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "http://localhost:4000/api/marketplace/offers/my/received?status=pending",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "marketplace", "offers", "my", "received"],
              "query": [
                {
                  "key": "status",
                  "value": "pending",
                  "description": "Filter by offer status"
                }
              ]
            },
            "description": "ğŸ“¨ **SELLER DASHBOARD: All Offers Received**\n\n**ğŸ“Š Cross-listing view:**\n- All offers across all my listings\n- Aggregated seller dashboard\n- Quick decision-making interface\n\n**Enhanced Response includes:**\n- Listing details for context\n- Buyer information\n- Offer details & timing\n- Action buttons ready"
          }
        },
        {
          "name": "âœ… Accept Offer (Complete Transaction)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Offer accepted successfully\", function () {",
                  "    pm.response.to.have.status(200);",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.eql(true);",
                  "    ",
                  "    console.log(\"âœ… TRANSACTION COMPLETED!\");",
                  "    console.log(\"ğŸ“ Status: Offer accepted\");",
                  "    console.log(\"ğŸ’° Final Price: \" + (jsonData.offer?.price?.amount / 1e18 || 'N/A') + \" ETH\");",
                  "    console.log(\"ğŸ  Listing Status: \" + (jsonData.listing?.status || 'Updated'));",
                  "    console.log(\"ğŸ”„ Other Offers: Automatically rejected\");",
                  "    console.log(\"\\nğŸ‰ NFT sale transaction complete!\");",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"transactionHash\": \"0x1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef\"\n}"
            },
            "url": {
              "raw": "http://localhost:4000/api/marketplace/offers/{{offer_id}}/accept",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "marketplace", "offers", "{{offer_id}}", "accept"]
            },
            "description": "âœ… **ACCEPT OFFER - Complete Marketplace Transaction**\n\n**ğŸ¯ This simulates the COMPLETE sale workflow:**\n\n**ğŸ”„ Automatic Effects:**\n1. âœ… **Offer Status** â†’ `accepted`\n2. ğŸ  **Listing Status** â†’ `sold`\n3. âŒ **Other Offers** â†’ `rejected` (auto-cleanup)\n4. ğŸ“Š **Analytics** â†’ Updated (views, sales count)\n5. ğŸ”„ **Fast Read APIs** â†’ Immediately reflect changes\n\n**ğŸ’° In Production Workflow:**\n```\n1. Buyer creates offer â†’ Pending\n2. Seller accepts â†’ Smart contract buyItem() called\n3. Blockchain transaction â†’ Automatic NFT + ETH transfer\n4. Transaction hash â†’ Recorded for verification\n5. Event indexer â†’ Auto-syncs to MongoDB\n6. All APIs â†’ Updated in real-time\n```\n\n**ğŸš€ Enhanced Response:**\n```json\n{\n  \"success\": true,\n  \"message\": \"Offer accepted and listing marked as sold\",\n  \"offer\": {\n    \"_id\": \"offer_id\",\n    \"status\": \"accepted\",\n    \"respondedAt\": \"2025-11-01T...\",\n    \"price\": {\n      \"amount\": \"70000000000000000000\",\n      \"currency\": \"ETH\"\n    }\n  },\n  \"listing\": {\n    \"_id\": \"listing_id\",\n    \"status\": \"sold\",\n    \"soldAt\": \"2025-11-01T...\"\n  },\n  \"rejectedOffers\": 0,\n  \"transactionHash\": \"0x1234567890abcdef...\"\n}\n```\n\n**âœ… Verification Steps:**\n1. ğŸš€ Run **Fast Read APIs** â†’ Listing should be `sold`\n2. ğŸ“Š Check **Marketplace Homepage** â†’ Updated stats\n3. ğŸ’¼ Check **Buyer Dashboard** â†’ Offer shows `accepted`\n4. ğŸ“¨ Check **Seller Dashboard** â†’ Other offers `rejected`\n\n**ğŸ‰ SUCCESS: Complete NFT marketplace transaction workflow!**"
          }
        },
        {
          "name": "âŒ Reject Offer",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"message\": \"Thank you for your offer, but I'm looking for a higher price. Feel free to make another offer.\"\n}"
            },
            "url": {
              "raw": "http://localhost:4000/api/marketplace/offers/{{offer_id}}/reject",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "marketplace", "offers", "{{offer_id}}", "reject"]
            },
            "description": "âŒ **REJECT OFFER** with Response Message\n\n**Enhanced Features:**\n- ğŸ’¬ **Response message** to buyer\n- ğŸ“§ **Notification** to buyer (if implemented)\n- ğŸ”„ **Listing remains active** for other offers\n- ğŸ“Š **Analytics tracking** of rejection rates\n\n**Use Case:** Polite rejection with feedback for better negotiation"
          }
        },
        {
          "name": "ğŸ—‘ï¸ Cancel Offer (Buyer)",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "http://localhost:4000/api/marketplace/offers/{{offer_id}}",
              "protocol": "http",
              "host": ["localhost"],
              "port": "4000",
              "path": ["api", "marketplace", "offers", "{{offer_id}}"]
            },
            "description": "ğŸ—‘ï¸ **CANCEL OFFER** (Buyer only)\n\n**When to use:**\n- Changed mind about purchase\n- Found better property\n- Price negotiation strategy\n- Before offer expires\n\n**Effect:** Offer status â†’ `cancelled`, removed from seller's pending list"
          }
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "test_wallet_with_nft",
      "value": "0xc6890b26a32d9d92aefbc8635c4588247529cdfe",
      "type": "string",
      "description": "âœ… Test wallet address that has NFTs (balance: 1, tokenId: 1)"
    },
    {
      "key": "test_listing_id",
      "value": "69060885436f7c5880be62c5",
      "type": "string",
      "description": "âœ… Existing listing ID for testing (PhÃ²ng 1124 E4, 50 ETH)"
    },
    {
      "key": "test_property_id",
      "value": "6905c41423f8d019f2eb2ad6",
      "type": "string",
      "description": "âœ… Existing property ID for testing"
    },
    {
      "key": "nft_contract_address",
      "value": "0x4Cf97592f58e9f266BAce5405602c97c9bFc4F48",
      "type": "string",
      "description": "âœ… NFT Contract Address (ViePropChainNFT with ERC721Enumerable)"
    },
    {
      "key": "marketplace_contract_address",
      "value": "0xcA41659cCfcD6a385381f22A2CE53c2b451e3c38",
      "type": "string",
      "description": "âœ… Marketplace Contract Address"
    },
    {
      "key": "ganache_test_wallet",
      "value": "0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb2",
      "type": "string",
      "description": "âœ… Ganache wallet for testing (Account 0)"
    },
    {
      "key": "ganache_private_key",
      "value": "0x4f3edf983ac636a65a842ce7c78d9aa706d3b113bce9c46f30d7d21715b23b1d",
      "type": "string",
      "description": "âš ï¸ Ganache private key for signature generation (TEST ONLY)"
    },
    {
      "key": "found_token_id",
      "value": "1",
      "type": "string",
      "description": "âœ… Token ID found from NFT query test"
    },
    {
      "key": "jwt_token",
      "value": "",
      "type": "string",
      "description": "ğŸ” JWT token tá»« Gmail OAuth (paste sau khi login) - GET from browser"
    },
    {
      "key": "user_id",
      "value": "",
      "type": "string",
      "description": "ğŸ‘¤ User ID tá»« Auth Service - AUTO-SET tá»« Get My Info"
    },
    {
      "key": "user_email",
      "value": "",
      "type": "string",
      "description": "ğŸ“§ Email tá»« Gmail - AUTO-SET tá»« Get My Info"
    },
    {
      "key": "user_wallet",
      "value": "",
      "type": "string",
      "description": "ğŸ’¼ Wallet address sau khi link (optional) - AUTO-SET tá»« Link Wallet"
    },
    {
      "key": "property_id",
      "value": "",
      "type": "string",
      "description": "ğŸ  Property ID - AUTO-SET tá»« Create Property"
    },
    {
      "key": "image_cid",
      "value": "",
      "type": "string",
      "description": "ğŸ“· IPFS CID cá»§a áº£nh - AUTO-SET tá»« Upload Image"
    },
    {
      "key": "metadata_cid",
      "value": "",
      "type": "string",
      "description": "ğŸ“ IPFS CID cá»§a metadata - AUTO-SET tá»« Upload Metadata"
    },
    {
      "key": "token_id",
      "value": "",
      "type": "string",
      "description": "ğŸ¨ NFT Token ID - AUTO-SET tá»« Admin Mint NFT"
    },
    {
      "key": "listing_id",
      "value": "",
      "type": "string",
      "description": "ğŸ’° Marketplace Listing ID - AUTO-SET tá»« Create Listing"
    },
    {
      "key": "offer_id",
      "value": "",
      "type": "string",
      "description": "ğŸ’µ Offer ID - AUTO-SET tá»« Create Offer"
    }
  ]
}
